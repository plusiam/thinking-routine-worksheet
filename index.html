<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¬ê³ ê°€ì‹œí™” ì›¹í•™ìŠµì§€ - ë³´ê¸°Â·ìƒê°í•˜ê¸°Â·ê¶ê¸ˆí•´í•˜ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        .thinking-step {
            transition: all 0.3s ease;
        }
        
        .thinking-step:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .step-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: 600;
            color: white;
            margin-bottom: 1rem;
        }
        
        .step-see .step-icon { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
        .step-think .step-icon { background: linear-gradient(135deg, #8b5cf6, #6d28d9); }
        .step-wonder .step-icon { background: linear-gradient(135deg, #06b6d4, #0891b2); }
        
        textarea:focus, input:focus {
            outline: none;
            ring: 2px;
            ring-color: #3b82f6;
            border-color: #3b82f6;
        }
        
        .save-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            transition: all 0.3s ease;
        }
        
        .save-btn:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        
        .reset-btn {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            transition: all 0.3s ease;
        }
        
        .reset-btn:hover {
            background: linear-gradient(135deg, #d97706, #b45309);
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
        }
        
        @media print {
            .no-print { display: none !important; }
        }
        
        .worksheet-content {
            background: linear-gradient(135deg, #fefbff 0%, #f8fafc 100%);
            min-height: 100vh;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- í—¤ë” -->
    <header class="bg-white shadow-lg border-b-4 border-indigo-500 no-print">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">ğŸ¯ ì‚¬ê³ ê°€ì‹œí™” ì›¹í•™ìŠµì§€</h1>
                    <p class="text-gray-600 text-lg">ë³´ê¸° Â· ìƒê°í•˜ê¸° Â· ê¶ê¸ˆí•´í•˜ê¸°</p>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-3">
                    <button id="resetBtn" class="reset-btn text-white px-6 py-3 rounded-lg font-medium shadow-lg">
                        ğŸ”„ ìƒˆë¡œ ì‘ì„±
                    </button>
                    <button id="saveBtn" class="save-btn text-white px-6 py-3 rounded-lg font-medium shadow-lg">
                        ğŸ’¾ ì´ë¯¸ì§€ë¡œ ì €ì¥
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <main class="worksheet-content" id="worksheetContent">
        <div class="container mx-auto px-4 py-8">
            <!-- í•™ìŠµì§€ ì œëª© ë° ì‘ì„±ì ì •ë³´ -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-8 border border-gray-200">
                <!-- í•™ìŠµì§€ ì œëª© -->
                <div class="mb-6">
                    <label for="worksheetTitle" class="block text-lg font-semibold text-gray-800 mb-3">
                        ğŸ“ í•™ìŠµì§€ ì œëª©
                    </label>
                    <input 
                        type="text" 
                        id="worksheetTitle" 
                        placeholder="ì˜ˆ: ã€í•‘!ã€ í‘œì§€ íƒìƒ‰í•˜ê¸°, ã€ê³° ì‚¬ëƒ¥ì„ ë– ë‚˜ìã€ í‘œì§€ ë¶„ì„ ë“±"
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg text-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-colors"
                    />
                    <p class="text-sm text-gray-500 mt-2">ğŸ’¡ í˜„ì¬ íƒìƒ‰í•˜ê³  ìˆëŠ” ê·¸ë¦¼ì±…ì´ë‚˜ í™œë™ì˜ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
                </div>

                <!-- ì‘ì„±ì ì •ë³´ -->
                <div class="border-t pt-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ‘¤ ì‘ì„±ì ì •ë³´</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label for="schoolName" class="block text-sm font-medium text-gray-700 mb-2">
                                ğŸ« í•™êµëª…
                            </label>
                            <input 
                                type="text" 
                                id="schoolName" 
                                placeholder="â—‹â—‹ì´ˆë“±í•™êµ"
                                class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-colors"
                            />
                        </div>
                        <div>
                            <label for="classInfo" class="block text-sm font-medium text-gray-700 mb-2">
                                ğŸ“š í•™ë…„ë°˜
                            </label>
                            <input 
                                type="text" 
                                id="classInfo" 
                                placeholder="3í•™ë…„ 2ë°˜"
                                class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-colors"
                            />
                        </div>
                        <div>
                            <label for="studentName" class="block text-sm font-medium text-gray-700 mb-2">
                                âœï¸ ì´ë¦„
                            </label>
                            <input 
                                type="text" 
                                id="studentName" 
                                placeholder="í™ê¸¸ë™"
                                class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-colors"
                            />
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì‚¬ê³  ë£¨í‹´ 3ë‹¨ê³„ -->
            <div class="grid gap-8">
                <!-- 1ë‹¨ê³„: ë³´ê¸° -->
                <div class="thinking-step step-see bg-white rounded-xl shadow-lg p-6 border border-blue-200">
                    <div class="flex items-start gap-4">
                        <div class="step-icon">ğŸ”</div>
                        <div class="flex-1">
                            <h3 class="text-xl font-bold text-gray-800 mb-3">1ë‹¨ê³„: ë³´ê¸° (ê´€ì°°í•˜ê¸°)</h3>
                            <label for="seeContent" class="block text-gray-700 font-medium mb-3">
                                í‘œì§€(ê·¸ë¦¼)ì—ì„œ ë¬´ì—‡ì´ ë³´ì´ë‚˜ìš”? ìƒ‰ê¹”, ì¸ë¬¼, ë°°ê²½, í‘œì •, ì‚¬ë¬¼ ë“±ì„ ìì„¸íˆ ê´€ì°°í•´ë³´ì„¸ìš”.
                            </label>
                            <textarea 
                                id="seeContent"
                                rows="6"
                                placeholder="ì˜ˆì‹œ:
â€¢ ì£¼ì¸ê³µì˜ ëª¨ìŠµ: 
â€¢ ë°°ê²½: 
â€¢ ìƒ‰ê¹”: 
â€¢ í‘œì •ì´ë‚˜ ë™ì‘: 
â€¢ ëˆˆì— ë„ëŠ” ì‚¬ë¬¼ë“¤: 
â€¢ ê¸€ìì˜ ëª¨ì–‘ì´ë‚˜ ìœ„ì¹˜: "
                                class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg resize-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-colors text-gray-800"
                            ></textarea>
                            <p class="text-sm text-blue-600 mt-2">ğŸ’¡ íŒë‹¨í•˜ì§€ ë§ê³  ìˆëŠ” ê·¸ëŒ€ë¡œ ê´€ì°°í•œ ê²ƒë§Œ ì ì–´ë³´ì„¸ìš”.</p>
                        </div>
                    </div>
                </div>

                <!-- 2ë‹¨ê³„: ìƒê°í•˜ê¸° -->
                <div class="thinking-step step-think bg-white rounded-xl shadow-lg p-6 border border-purple-200">
                    <div class="flex items-start gap-4">
                        <div class="step-icon">ğŸ’­</div>
                        <div class="flex-1">
                            <h3 class="text-xl font-bold text-gray-800 mb-3">2ë‹¨ê³„: ìƒê°í•˜ê¸° (ì¶”ë¡ í•˜ê¸°)</h3>
                            <label for="thinkContent" class="block text-gray-700 font-medium mb-3">
                                ê´€ì°°í•œ ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ ì´ ê·¸ë¦¼ì±…ì—ì„œëŠ” ì–´ë–¤ ì´ì•¼ê¸°ê°€ í¼ì³ì§ˆ ê²ƒ ê°™ë‚˜ìš”? ì™œ ê·¸ë ‡ê²Œ ìƒê°í•˜ë‚˜ìš”?
                            </label>
                            <textarea 
                                id="thinkContent"
                                rows="6"
                                placeholder="ì˜ˆì‹œ:
â€¢ ì–´ë–¤ ì´ì•¼ê¸°ê°€ í¼ì³ì§ˆ ê²ƒ ê°™ë‚˜ìš”: 
â€¢ ì£¼ì¸ê³µì—ê²Œ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚  ê²ƒ ê°™ë‚˜ìš”: 
â€¢ ì´ì•¼ê¸°ì˜ ë¶„ìœ„ê¸°ëŠ” ì–´ë–¨ ê²ƒ ê°™ë‚˜ìš”: 
â€¢ ê·¸ë ‡ê²Œ ìƒê°í•˜ëŠ” ì´ìœ ëŠ”: 
â€¢ ì œëª©ê³¼ ê·¸ë¦¼ì„ ì—°ê²°í•´ì„œ ìƒê°í•´ë³´ë©´: "
                                class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg resize-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-colors text-gray-800"
                            ></textarea>
                            <p class="text-sm text-purple-600 mt-2">ğŸ’¡ ê´€ì°°í•œ ë‚´ìš©ì„ ê·¼ê±°ë¡œ ë“¤ì–´ ì¶”ë¡ í•´ë³´ì„¸ìš”.</p>
                        </div>
                    </div>
                </div>

                <!-- 3ë‹¨ê³„: ê¶ê¸ˆí•´í•˜ê¸° -->
                <div class="thinking-step step-wonder bg-white rounded-xl shadow-lg p-6 border border-cyan-200">
                    <div class="flex items-start gap-4">
                        <div class="step-icon">â“</div>
                        <div class="flex-1">
                            <h3 class="text-xl font-bold text-gray-800 mb-3">3ë‹¨ê³„: ê¶ê¸ˆí•´í•˜ê¸° (ì§ˆë¬¸í•˜ê¸°)</h3>
                            <label for="wonderContent" class="block text-gray-700 font-medium mb-3">
                                ì´ ê·¸ë¦¼ì±…ì— ëŒ€í•´ ê¶ê¸ˆí•œ ê²ƒì€ ë¬´ì—‡ì¸ê°€ìš”? ë” ì•Œê³  ì‹¶ì€ ê²ƒì´ ìˆë‚˜ìš”?
                            </label>
                            <textarea 
                                id="wonderContent"
                                rows="6"
                                placeholder="ì˜ˆì‹œ:
â€¢ ì£¼ì¸ê³µì€ ëˆ„êµ¬ì¼ê¹Œìš”? 
â€¢ ì™œ ì´ëŸ° í‘œì •ì„ ì§“ê³  ìˆì„ê¹Œìš”? 
â€¢ ì œëª©ì˜ ì˜ë¯¸ëŠ” ë¬´ì—‡ì¼ê¹Œìš”? 
â€¢ ì´ì•¼ê¸°ëŠ” ì–´ë–»ê²Œ ëë‚ ê¹Œìš”? 
â€¢ ì‘ê°€ëŠ” ì™œ ì´ëŸ° ìƒ‰ê¹”ì„ ì‚¬ìš©í–ˆì„ê¹Œìš”? 
â€¢ ë‚´ê°€ ì£¼ì¸ê³µì´ë¼ë©´ ì–´ë–¤ ê¸°ë¶„ì¼ê¹Œìš”? "
                                class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg resize-none focus:border-cyan-500 focus:ring-2 focus:ring-cyan-200 transition-colors text-gray-800"
                            ></textarea>
                            <p class="text-sm text-cyan-600 mt-2">ğŸ’¡ í˜¸ê¸°ì‹¬ì„ ê°€ì§€ê³  ììœ ë¡­ê²Œ ì§ˆë¬¸í•´ë³´ì„¸ìš”.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- í•˜ë‹¨ ì •ë³´ -->
            <div class="mt-8 text-center">
                <div class="bg-white rounded-lg shadow-md p-4 inline-block">
                    <p class="text-gray-600 text-sm">
                        ğŸ“š <strong>ì‚¬ê³ ê°€ì‹œí™” ì›¹í•™ìŠµì§€</strong> | ê·¸ë¦¼ì±…ì„ í†µí•œ ê¹Šì´ ìˆëŠ” ì‚¬ê³  ê²½í—˜
                    </p>
                    <p class="text-gray-500 text-xs mt-1" id="currentDate"></p>
                </div>
            </div>
        </div>
    </main>

    <!-- ì €ì¥ ì™„ë£Œ ì•Œë¦¼ ëª¨ë‹¬ -->
    <div id="saveModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl shadow-2xl p-8 max-w-md mx-4">
            <div class="text-center">
                <div class="text-6xl mb-4">âœ…</div>
                <h3 class="text-xl font-bold text-gray-800 mb-2">ì €ì¥ ì™„ë£Œ!</h3>
                <p class="text-gray-600 mb-4">í•™ìŠµì§€ê°€ ì´ë¯¸ì§€ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                <button id="closeModal" class="bg-indigo-500 text-white px-6 py-2 rounded-lg font-medium hover:bg-indigo-600 transition-colors">
                    í™•ì¸
                </button>
            </div>
        </div>
    </div>

    <script>
        // DOM ìš”ì†Œ ì„ íƒ
        const saveBtn = document.getElementById('saveBtn');
        const resetBtn = document.getElementById('resetBtn');
        const worksheetContent = document.getElementById('worksheetContent');
        const saveModal = document.getElementById('saveModal');
        const closeModal = document.getElementById('closeModal');
        const currentDate = document.getElementById('currentDate');
        const worksheetTitle = document.getElementById('worksheetTitle');
        const schoolName = document.getElementById('schoolName');
        const classInfo = document.getElementById('classInfo');
        const studentName = document.getElementById('studentName');
        const seeContent = document.getElementById('seeContent');
        const thinkContent = document.getElementById('thinkContent');
        const wonderContent = document.getElementById('wonderContent');

        // í˜„ì¬ ë‚ ì§œ í‘œì‹œ
        currentDate.textContent = new Date().toLocaleDateString('ko-KR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            weekday: 'long'
        });

        // ì´ë¯¸ì§€ ì €ì¥ ê¸°ëŠ¥
        saveBtn.addEventListener('click', async () => {
            try {
                // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ë¡œë”© í‘œì‹œ
                saveBtn.disabled = true;
                saveBtn.innerHTML = 'ğŸ”„ ì €ì¥ ì¤‘...';
                
                // html2canvasë¡œ ì´ë¯¸ì§€ ìƒì„±
                const canvas = await html2canvas(worksheetContent, {
                    backgroundColor: '#ffffff',
                    scale: 2, // ê³ í•´ìƒë„
                    useCORS: true,
                    allowTaint: true,
                    height: worksheetContent.scrollHeight,
                    width: worksheetContent.scrollWidth
                });

                // ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
                const link = document.createElement('a');
                const title = worksheetTitle.value || 'ì‚¬ê³ ê°€ì‹œí™”_í•™ìŠµì§€';
                const name = studentName.value ? `_${studentName.value}` : '';
                const fileName = `${title}${name}_${new Date().toISOString().split('T')[0]}.png`;
                
                link.download = fileName;
                link.href = canvas.toDataURL('image/png');
                link.click();

                // ì„±ê³µ ëª¨ë‹¬ í‘œì‹œ
                saveModal.classList.remove('hidden');
                
            } catch (error) {
                console.error('ì €ì¥ ì‹¤íŒ¨:', error);
                alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            } finally {
                // ë²„íŠ¼ ë³µì›
                saveBtn.disabled = false;
                saveBtn.innerHTML = 'ğŸ’¾ ì´ë¯¸ì§€ë¡œ ì €ì¥';
            }
        });

        // ì´ˆê¸°í™” ê¸°ëŠ¥
        resetBtn.addEventListener('click', () => {
            if (confirm('ì‘ì„±í•œ ë‚´ìš©ì´ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                worksheetTitle.value = '';
                schoolName.value = '';
                classInfo.value = '';
                studentName.value = '';
                seeContent.value = '';
                thinkContent.value = '';
                wonderContent.value = '';
                
                // ì²« ë²ˆì§¸ ì…ë ¥ í•„ë“œë¡œ í¬ì»¤ìŠ¤ ì´ë™
                worksheetTitle.focus();
                
                // ì„±ê³µ ì•Œë¦¼
                const resetAlert = document.createElement('div');
                resetAlert.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                resetAlert.textContent = 'âœ… ì´ˆê¸°í™” ì™„ë£Œ';
                document.body.appendChild(resetAlert);
                
                setTimeout(() => {
                    resetAlert.remove();
                }, 2000);
            }
        });

        // ëª¨ë‹¬ ë‹«ê¸°
        closeModal.addEventListener('click', () => {
            saveModal.classList.add('hidden');
        });

        // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ìœ¼ë¡œ ë‹«ê¸°
        saveModal.addEventListener('click', (e) => {
            if (e.target === saveModal) {
                saveModal.classList.add('hidden');
            }
        });

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', (e) => {
            // Ctrl+S: ì €ì¥
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveBtn.click();
            }
            
            // Ctrl+R: ì´ˆê¸°í™” (ê¸°ë³¸ ìƒˆë¡œê³ ì¹¨ ë°©ì§€)
            if (e.ctrlKey && e.key === 'r') {
                e.preventDefault();
                resetBtn.click();
            }
            
            // ESC: ëª¨ë‹¬ ë‹«ê¸°
            if (e.key === 'Escape') {
                saveModal.classList.add('hidden');
            }
        });

        // ìë™ ì €ì¥ (ë¡œì»¬ ìŠ¤í† ë¦¬ì§€)
        const autoSave = () => {
            const data = {
                title: worksheetTitle.value,
                school: schoolName.value,
                class: classInfo.value,
                name: studentName.value,
                see: seeContent.value,
                think: thinkContent.value,
                wonder: wonderContent.value,
                timestamp: Date.now()
            };
            localStorage.setItem('thinkingRoutineWorksheet', JSON.stringify(data));
        };

        // ìë™ ë³µì›
        const autoRestore = () => {
            const saved = localStorage.getItem('thinkingRoutineWorksheet');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    // 24ì‹œê°„ ë‚´ì˜ ë°ì´í„°ë§Œ ë³µì›
                    if (Date.now() - data.timestamp < 24 * 60 * 60 * 1000) {
                        worksheetTitle.value = data.title || '';
                        schoolName.value = data.school || '';
                        classInfo.value = data.class || '';
                        studentName.value = data.name || '';
                        seeContent.value = data.see || '';
                        thinkContent.value = data.think || '';
                        wonderContent.value = data.wonder || '';
                    }
                } catch (e) {
                    console.log('ìë™ ë³µì› ì‹¤íŒ¨:', e);
                }
            }
        };

        // ì…ë ¥ í•„ë“œì— ìë™ ì €ì¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        [worksheetTitle, schoolName, classInfo, studentName, seeContent, thinkContent, wonderContent].forEach(element => {
            element.addEventListener('input', autoSave);
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ë³µì›
        autoRestore();

        // í…ìŠ¤íŠ¸ ì˜ì—­ ìë™ ë†’ì´ ì¡°ì ˆ
        const textareas = document.querySelectorAll('textarea');
        textareas.forEach(textarea => {
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = this.scrollHeight + 'px';
            });
        });

        // ì ‘ê·¼ì„±: Tab í‚¤ ë„¤ë¹„ê²Œì´ì…˜ ê°œì„ 
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Tab') {
                const focusableElements = document.querySelectorAll(
                    'input, textarea, button, [tabindex]:not([tabindex="-1"])'
                );
                const firstElement = focusableElements[0];
                const lastElement = focusableElements[focusableElements.length - 1];

                if (e.shiftKey) {
                    if (document.activeElement === firstElement) {
                        e.preventDefault();
                        lastElement.focus();
                    }
                } else {
                    if (document.activeElement === lastElement) {
                        e.preventDefault();
                        firstElement.focus();
                    }
                }
            }
        });

        console.log('ğŸ¯ ì‚¬ê³ ê°€ì‹œí™” ì›¹í•™ìŠµì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
        console.log('ğŸ“š GitHub Pages ë°°í¬ ì¤€ë¹„ ì™„ë£Œ');
    </script>
</body>
</html>